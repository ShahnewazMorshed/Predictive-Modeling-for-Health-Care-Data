# Predicting Patient Length of Stay (LOS) for Efficient Hospital Management

**Author**: Mohammad Shahnewaz Morshed  
**Date**: 10 March 2024

## Abstract
A statistical framework was developed to predict hospital **Length of Stay (LOS)** at admission, a critical, discrete, and non-negative outcome in healthcare management. To address the right-skewed distribution and overdispersion characteristic of LOS data, tailored count-based models were employed to account for greater variability than standard approaches permit. Additionally, mixture models were integrated to capture the frequent occurrence of short stays, such as same-day or one-day admissions, ensuring accurate differentiation from longer hospitalizations. These methodological enhancements significantly improved prediction accuracy and provided well-calibrated forecasts, supporting robust hospital resource planning.

## Problem Formulation
Length of Stay (LOS) is defined as the number of calendar days between admission and discharge. Statistically, LOS is a non-negative, discrete outcome. Empirically, LOS exhibits right skewness and overdispersion, where the variance exceeds the mean. Ignoring these properties leads to inefficient estimates and biased predictions, resulting in misallocation of hospital resources.

## Methodology

### Statistical Characterization of LOS Predictors
The modeling approach was initially formulated using Poisson regression, recognized as the standard model for count outcomes due to its simplicity and ability to ensure non-negative predictions with interpretable coefficients. However, an empirical analysis of the LOS variable was conducted, revealing that the sample variance substantially exceeded the sample mean, indicating overdispersion. This condition causes underestimated standard errors and inflated error rates in Poisson regression. Consequently, the model was extended to a Negative Binomial specification to accommodate greater variability and provide more reliable inference when patient heterogeneity increases variance.

Further examination of the distribution was performed, indicating a higher frequency of very short stays, such as same-day or near-zero discharges, than predicted by standard models. A Zero-Inflated model was therefore adopted to capture the excess occurrence of short stays without distorting the overall distribution. Additionally, the predictor space, which included high-dimensional categorical variables like physician identifiers and ward codes, was addressed through penalized regression methods. The Least Absolute Shrinkage and Selection Operator (LASSO) was applied to select influential predictors and reduce overfitting by enforcing sparsity. The Elastic Net was also employed, combining sparsity with grouping and stability properties, particularly suitable for correlated predictors.

Model interpretability was improved through the application of Shapley value decomposition, derived from cooperative game theory. For each patient, the predicted LOS was decomposed to quantify the contribution of each predictor, calculated across all possible feature combinations. This method was selected for its rigorous, distribution-based measure of predictor importance, ensuring consistency across diverse model classes and delivering locally accurate attributions at the individual prediction level. Unlike regression coefficients, which rely on linearity assumptions, Shapley value decomposition maintains additive and comparable contributions, even in nonlinear models.

### Development and Validation of Predictive ML Models: Capturing Nonlinearities and Interactions
To effectively model the complex, nonlinear relationships and interactions among predictors influencing hospital Length of Stay (LOS), tree-based ensemble methods, including Random Forest (RF), Gradient Boosting Machine (GBM), and Extreme Gradient Boosting (XGBoost), were employed. These models were trained and validated using k-fold Grouped Cross-Validation (CV) with grouping by patient ID to prevent information leakage across multiple admissions of the same patient, ensuring robust and unbiased performance estimates. Model performance was evaluated using standard regression metrics, namely Root Mean Square Error (RMSE), Mean Absolute Error (MAE), and the coefficient of determination (R-squared), to assess prediction accuracy and goodness-of-fit. Additionally, to explore classification performance, LOS was optionally discretized into categorical bins, enabling the assessment of Area Under the Receiver Operating Characteristic Curve (AUROC) and F1-score for predictive discrimination and balance between precision and recall. Calibration diagnostics, such as reliability curves, were incorporated to verify the alignment between predicted and observed LOS values, ensuring the reliability of probabilistic forecasts for operational use.

### Operational Insights and Policy Implications
Predictions were translated into actionable insights to optimize hospital resource allocation. Average Marginal Effects (AMEs), Partial Dependence, and SHAP interaction effects were computed to quantify the impact of operational levers, such as staffing levels and bed capacity, on Length of Stay (LOS). AMEs were used to estimate the average change in LOS associated with a unit change in a predictor, providing a clear measure for resource planning. Partial Dependence analyses were conducted to illustrate how individual predictors influence LOS across their range, offering insights into their marginal effects. SHAP interaction effects were analyzed to capture the combined impacts of predictor pairs, enhancing the interpretability of complex relationships. Additionally, scenario analyses were performed to simulate changes in LOS under hypothetical resource allocation scenarios, such as increased staffing or bed availability. These analyses, while informative, were associational in nature and require integration with causal inference methods to establish definitive causal relationships.
